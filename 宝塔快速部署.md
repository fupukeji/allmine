# ⚡ 宝塔面板部署TimeValue - 5分钟快速指南

> 专为使用宝塔面板的用户设计的极简部署指南

---

## 🎯 部署流程（5步）

### 📦 第1步：安装Docker（2分钟）

```
1. 登录宝塔面板: http://60.205.161.210:8888
2. 点击【软件商店】
3. 搜索【Docker管理器】
4. 点击【安装】
5. ✅ 等待安装完成
```

---

### 📂 第2步：上传项目（1分钟）

**方式一：使用Git（推荐）**

```
1. 点击【终端】
2. 执行:
   cd /opt
   git clone https://github.com/fupukeji/timevalue.git
   cd timevalue
```

**方式二：上传压缩包**

```
1. 点击【文件】→进入 /opt
2. 新建文件夹 timevalue
3. 上传项目压缩包
4. 解压
```

---

### 🔑 第3步：配置MySQL（1分钟）

```
1. 点击【数据库】→【phpMyAdmin】
2. 点击【SQL】标签
3. 复制粘贴以下SQL并执行:
```

```sql
GRANT ALL PRIVILEGES ON timevalue.* TO 'timevalue'@'%' IDENTIFIED BY 'sdA3GThaTaDx3h8S';
GRANT ALL PRIVILEGES ON timevalue.* TO 'timevalue'@'172.%.%.%' IDENTIFIED BY 'sdA3GThaTaDx3h8S';
ALTER USER 'timevalue'@'%' IDENTIFIED WITH mysql_native_password BY 'sdA3GThaTaDx3h8S';
FLUSH PRIVILEGES;
```

---

### 🚀 第4步：构建并启动（2分钟）

```
1. 点击【终端】
2. 执行以下命令:

cd /opt/timevalue
docker-compose -f docker-compose.server.yml build
docker-compose -f docker-compose.server.yml --env-file .env.docker up -d
```

---

### 🔓 第5步：开放端口（30秒）

```
1. 点击【安全】
2. 点击【添加规则】
3. 填写:
   - 端口: 5000
   - 协议: TCP
   - 策略: 放行
4. 点击【确定】
```

**不要忘记**: 在云服务器控制台的安全组也要开放5000端口！

---

## ✅ 验证部署

### 检查容器状态

```
1. 点击【Docker】→【容器】
2. 查看 timevalue-backend 状态
3. 应该显示【运行中】（绿色）
```

### 测试健康检查

**浏览器访问**: http://60.205.161.210:5000/api/health

**预期返回**:
```json
{
  "status": "healthy",
  "service": "timevalue-backend",
  "checks": {
    "database": {"status": "up"},
    "environment": {"status": "up"}
  }
}
```

---

## 🛠️ 常用操作

### 查看日志

```
【Docker】→【容器】→找到 timevalue-backend →【日志】
```

### 重启容器

```
【Docker】→【容器】→找到 timevalue-backend →【重启】
```

### 进入容器

```
【Docker】→【容器】→找到 timevalue-backend →【终端】
```

### 备份数据库

```
【数据库】→找到 timevalue →【备份】
```

---

## 🔍 故障排查

### 容器无法启动？

```
1. 查看日志: 【Docker】→【容器】→【日志】
2. 检查端口: 【终端】→ netstat -tulpn | grep :5000
3. 重新构建: 【终端】→ docker-compose build
```

### 数据库连接失败？

```
1. 检查MySQL状态: 【软件商店】→【MySQL】→查看状态
2. 重新执行第3步的SQL授权
3. 重启MySQL: 【软件商店】→【MySQL】→【重启】
```

### 无法外网访问？

```
1. 检查宝塔防火墙: 【安全】→确认5000端口已放行
2. 检查云安全组: 登录云控制台→安全组→确认5000端口开放
3. 测试本地: 【终端】→ curl http://localhost:5000/api/health
```

---

## 📋 部署检查清单

- [ ] Docker管理器已安装
- [ ] 项目已上传到 /opt/timevalue
- [ ] MySQL权限已配置（执行了SQL语句）
- [ ] 镜像已构建成功
- [ ] 容器状态为【运行中】
- [ ] 宝塔防火墙5000端口已放行
- [ ] 云服务器安全组5000端口已开放
- [ ] 健康检查返回正常
- [ ] 可以外网访问

---

## 🎯 访问信息

```
后端API:    http://60.205.161.210:5000
健康检查:   http://60.205.161.210:5000/api/health
宝塔面板:   http://60.205.161.210:8888
管理员:     admin / admin123
```

⚠️ **首次登录后请立即修改密码！**

---

## 📚 更多信息

- **详细教程**: [宝塔Docker部署指南.md](宝塔Docker部署指南.md)
- **技术细节**: [服务器Docker部署指南.md](服务器Docker部署指南.md)
- **通用部署**: [DOCKER_DEPLOYMENT.md](DOCKER_DEPLOYMENT.md)

---

> 🎉 **5分钟部署完成！享受宝塔的便捷管理吧！**
